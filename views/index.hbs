<section class="hero-section py-5">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6 mb-4 mb-lg-0">
                <h1 class="display-4 fw-bold mb-3">Learn Faster with <span class="text-primary">Interactive Quizzes</span></h1>
                <p class="lead mb-4">Create, share, and master knowledge through engaging quiz experiences. Perfect for students, teachers, and lifelong learners.</p>
                <div class="d-flex flex-wrap gap-2">
                    <a href="/quiz/quizzes" class="btn btn-primary btn-lg">Create a Quiz</a>
                    <a href="#" class="btn btn-outline-light btn-lg">Try a Demo Quiz</a>
                </div>
                <div class="mt-4 d-flex align-items-center">
                    <div class="d-flex">
                        <div class="avatar-stack">
                            <span class="avatar">üë©üèΩ‚Äçüéì</span>
                            <span class="avatar">üë®üèª‚Äçüéì</span>
                            <span class="avatar">üë©üèø‚Äçüéì</span>
                            <span class="avatar">üë®üèº‚Äçüéì</span>
                        </div>
                    </div>
                    <div class="ms-3">
                        <p class="mb-0"><strong>50,000+</strong> learners joined this month</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="hero-image-container">
                    <img src="https://images.unsplash.com/photo-1519389950473-47ba0277781c" alt="Students collaborating with technology" class="img-fluid rounded-4 shadow">
                </div>
            </div>
        </div>
    </div>
</section>


<section class="leaderboard-section py-5">
  <div class="container">
    <div class="text-center mb-4">
      <h2 class="fw-bold">This Week's Top Learners</h2>
      <p class="lead text-muted">Compete with others and climb the ranks!</p>
    </div>
    
    <!-- League selection tabs -->
    <div class="league-tabs d-flex justify-content-center mb-4">
      <button class="btn btn-outline-primary px-4 py-2 me-2 active" data-criteria="score">Score League</button>
      <button class="btn btn-outline-primary px-4 py-2 me-2" data-criteria="attend">Attend League</button>
      <button class="btn btn-outline-primary px-4 py-2" data-criteria="mean">Mean League</button>
    </div>
    
    <div class="row">
      <!-- Top 3 podium -->
      <div class="col-lg-12 mb-4">
        <div class="podium-container d-flex justify-content-center align-items-end">
          <!-- Second place -->
          <div class="podium-item position-relative" id="second-place">
            <div class="podium-avatar silver-border">
              <img src="https://i.pravatar.cc/150?img=32" alt="Second place" class="rounded-circle">
              <div class="rank-badge silver">2</div>
            </div>
            <div class="podium-bar silver-bg" style="height: 120px;"></div>
            <div class="podium-info">
              <h5>Emma W.</h5>
              <p class="points"><span class="badge bg-secondary"><i class="fas fa-bolt"></i> 8,240</span></p>
            </div>
          </div>
          
          <!-- First place (taller) -->
          <div class="podium-item position-relative first-place" id="first-place">
            <div class="podium-crown position-absolute"><i class="fas fa-crown"></i></div>
            <div class="podium-avatar gold-border">
              <img src="https://i.pravatar.cc/150?img=67" alt="First place" class="rounded-circle">
              <div class="rank-badge gold">1</div>
            </div>
            <div class="podium-bar gold-bg" style="height: 160px;"></div>
            <div class="podium-info">
              <h5>David L.</h5>
              <p class="points"><span class="badge bg-warning text-dark"><i class="fas fa-bolt"></i> 9,845</span></p>
            </div>
          </div>
          
          <!-- Third place -->
          <div class="podium-item position-relative" id="third-place">
            <div class="podium-avatar bronze-border">
              <img src="https://i.pravatar.cc/150?img=15" alt="Third place" class="rounded-circle">
              <div class="rank-badge bronze">3</div>
            </div>
            <div class="podium-bar bronze-bg" style="height: 90px;"></div>
            <div class="podium-info">
              <h5>James T.</h5>
              <p class="points"><span class="badge bg-secondary"><i class="fas fa-bolt"></i> 7,125</span></p>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Leaderboard table -->
      <div class="col-lg-8 offset-lg-2">
        <div class="leaderboard-card bg-dark p-4 rounded-4 shadow">
          <div class="leaderboard-heading d-flex justify-content-between mb-3">
            <div>
              <h4 class="mb-0">Leaderboard</h4>
              <small class="text-muted" id="leaderboard-reset-text">Resets in 3 days, 8 hours</small>
            </div>
            <div class="dropdown">
              <button class="btn btn-sm btn-outline-light dropdown-toggle" type="button" id="leaderboardOptions" data-bs-toggle="dropdown" aria-expanded="false">
                Weekly
              </button>
              <ul class="dropdown-menu" aria-labelledby="leaderboardOptions">
                <li><a class="dropdown-item" href="javascript:void(0)" data-time="week">Weekly</a></li>
                <li><a class="dropdown-item" href="javascript:void(0)" data-time="month">Monthly</a></li>
                <li><a class="dropdown-item" href="javascript:void(0)" data-time="year">All Time</a></li>
              </ul>
            </div>
          </div>
          
          <ul class="leaderboard-list list-unstyled" id="leaderboard-players">
            <!-- Players will be loaded here -->
          </ul>
          
          <div class="mt-3 text-center">
            <button class="btn btn-sm btn-outline-light px-4" id="view-full-leaderboard">View Full Leaderboard</button>
          </div>
        </div>
      </div>
    </div>
    
    <div class="mt-4 text-center">
      <div class="leaderboard-prizes p-3 d-inline-block rounded-3 bg-dark">
        <h6 class="mb-3"><i class="fas fa-trophy text-warning me-2"></i> Weekly Prizes</h6>
        <div class="d-flex justify-content-center gap-3 text-center">
          <div class="prize-item">
            <div class="prize-icon gold-text mb-2"><i class="fas fa-medal"></i></div>
            <p class="small mb-0">1000 XP Boost</p>
          </div>
          <div class="prize-item">
            <div class="prize-icon silver-text mb-2"><i class="fas fa-medal"></i></div>
            <p class="small mb-0">500 XP Boost</p>
          </div>
          <div class="prize-item">
            <div class="prize-icon bronze-text mb-2"><i class="fas fa-medal"></i></div>
            <p class="small mb-0">250 XP Boost</p>
          </div>
        </div>
      </div>
    </div>
  </div>

</section>

<!-- Features Section -->
<section id="features" class="py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="fw-bold">Why Choose QuizMaster?</h2>
            <p class="lead text-muted">Our platform makes learning engaging and effective</p>
        </div>
        <div class="row g-4">
            {{#each features}}
                {{#if @index}}
                    {{#ifEquals @index 3}}
                        </div>
                        <div class="row g-4 mt-2">
                    {{/ifEquals}}
                {{/if}}
                <div class="col-md-4">
                    <div class="card h-100 border-0 bg-dark">
                        <div class="card-body text-center p-4">
                            <div class="feature-icon-container mb-3">
                                <i class="fas fa-{{this.icon}} fa-2x text-primary"></i>
                            </div>
                            <h4 class="fw-bold mb-3">{{this.title}}</h4>
                            <p class="card-text">{{this.description}}</p>
                        </div>
                    </div>
                </div>
            {{/each}}
        </div>
    </div>
</section>

<!-- Stats Section -->
<section class="py-5 bg-dark">
    <div class="container">
        <div class="row text-center">
            {{#each stats}}
                <div class="col-md-3 mb-4 mb-md-0">
                    <h2 class="fw-bold text-primary display-4 counter">{{this.value}}</h2>
                    <p class="lead">{{this.label}}</p>
                </div>
            {{/each}}
        </div>
    </div>
</section>

<!-- Subject Categories Section -->
<section id="subjects" class="py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="fw-bold">Explore Quiz Categories</h2>
            <p class="lead text-muted">Discover quizzes across a wide range of subjects</p>
        </div>
        <div class="row g-4">
            {{#each categories}}
                <div class="col-md-4 col-lg-3">
                    <div class="card h-100 border-0 category-card">
                        <div class="card-body p-4 text-center">
                            <div class="category-icon mb-3">
                                <i class="fas fa-{{this.icon}} fa-2x"></i>
                            </div>
                            <h5 class="card-title fw-bold">{{this.title}}</h5>
                            <p class="card-text text-muted">{{this.count}} Quizzes</p>
                            <a href="#" class="stretched-link"></a>
                        </div>
                    </div>
                </div>
            {{/each}}
        </div>
        <div class="text-center mt-4">
            <a href="#" class="btn btn-outline-light">View All Categories</a>
        </div>
    </div>
</section>

<!-- Demo Quiz Section -->
<section class="py-5 bg-dark">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-5 mb-4 mb-lg-0">
                <h2 class="fw-bold mb-3">Try Our Sample Quiz</h2>
                <p class="lead mb-4">Experience the interactive learning environment with this quick general knowledge quiz.</p>
                <div class="quiz-demo p-4 rounded-4 bg-dark border">
                    {{#each demoQuestions}}
                        <div class="demo-question mb-4">
                            <p class="fw-bold mb-2">{{inc @index}}. {{this.question}}</p>
                            {{#each this.options}}
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="radio" name="q{{inc ../index}}" id="{{this.id}}" value="{{this.value}}">
                                    <label class="form-check-label" for="{{this.id}}">{{this.value}}</label>
                                </div>
                            {{/each}}
                        </div>
                    {{/each}}
                    <button id="demo-submit" class="btn btn-primary">Check Answers</button>
                </div>
            </div>
            <div class="col-lg-7">
                <div class="row g-3">
                    <div class="col-md-6">
                        <img src="https://images.unsplash.com/photo-1530462943125-677cc511c87e" alt="Student taking a quiz" class="img-fluid rounded-4 shadow">
                    </div>
                    <div class="col-md-6">
                        <img src="https://images.unsplash.com/photo-1585432959449-b1c9c8cc49ac" alt="Quiz concept" class="img-fluid rounded-4 shadow">
                    </div>
                    <div class="col-12 mt-3">
                        <img src="https://images.unsplash.com/photo-1578593139862-d9b9d9693d57" alt="Learning environment" class="img-fluid rounded-4 shadow">
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- How It Works Section -->
<section id="how-it-works" class="py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="fw-bold">How QuizMaster Works</h2>
            <p class="lead text-muted">Simple steps to enhance your learning experience</p>
        </div>
        <div class="row g-4">
            {{#each steps}}
                <div class="col-md-4">
                    <div class="card h-100 border-0 bg-dark">
                        <div class="card-body text-center p-4">
                            <div class="step-number mb-3">{{this.number}}</div>
                            <h4 class="fw-bold mb-3">{{this.title}}</h4>
                            <p class="card-text">{{this.description}}</p>
                        </div>
                    </div>
                </div>
            {{/each}}
        </div>
    </div>
</section>

<!-- Testimonials Section -->
<section id="testimonials" class="py-5 bg-dark">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="fw-bold">What Our Users Say</h2>
            <p class="lead text-muted">Join thousands of satisfied learners</p>
        </div>
        <div class="row g-4">
            {{#each testimonials}}
                <div class="col-md-4">
                    <div class="card h-100 border-0 testimonial-card bg-dark">
                        <div class="card-body p-4">
                            <div class="d-flex align-items-center mb-4">
                                <div class="testimonial-image me-3">
                                    <span class="avatar">{{this.avatar}}</span>
                                </div>
                                <div>
                                    <h5 class="fw-bold mb-0">{{this.name}}</h5>
                                    <p class="text-muted mb-0">{{this.role}}</p>
                                </div>
                            </div>
                            <p class="testimonial-text">"{{this.text}}"</p>
                        </div>
                    </div>
                </div>
            {{/each}}
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="py-5">
    <div class="container">
        <div class="card cta-card text-white">
            <div class="card-body p-5 text-center">
                <h2 class="card-title fw-bold mb-3">Ready to Boost Your Learning?</h2>
                <p class="card-text lead mb-4">Join millions of students, teachers, and professionals who are already using QuizMaster.</p>
                <div class="d-flex justify-content-center gap-3 flex-wrap">
                    <a href="#" class="btn btn-light btn-lg">Get Started Free</a>
                    <a href="#" class="btn btn-outline-light btn-lg">Explore Features</a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Featured In Section -->
<section class="featured-section py-5">
  <div class="container">
    <div class="row row-cols-2 row-cols-md-4 row-cols-lg-6 g-4 justify-content-center">
      <!-- C√°c column hi·ªán t·∫°i -->
    </div>
  </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', function() {
      // Current selected filters
      let currentCriteria = 'score';
      let currentTime = 'week';
      
      // Load initial data
      loadLeaderboardData(currentCriteria, currentTime);
      
      // Add event listeners to league tabs
      document.querySelectorAll('.league-tabs button').forEach(button => {
        button.addEventListener('click', function() {
          // Update active state
          document.querySelectorAll('.league-tabs button').forEach(btn => btn.classList.remove('active'));
          this.classList.add('active');
          
          // Update criteria and reload data
          currentCriteria = this.getAttribute('data-criteria');
          loadLeaderboardData(currentCriteria, currentTime);
          
          // Update heading
          updateLeaderboardHeading(currentCriteria, currentTime);
        });
      });
      
      // Add event listeners to time dropdown items
      document.querySelectorAll('.dropdown-menu a').forEach(item => {
        item.addEventListener('click', function(e) {
          // NgƒÉn kh√¥ng cho trang cu·ªôn l√™n ƒë·∫ßu
          e.preventDefault();
          e.stopPropagation();
          
          // Update dropdown button text
          const newTime = this.getAttribute('data-time');
          let timeText = 'Weekly';
          
          if (newTime === 'month') timeText = 'Monthly';
          else if (newTime === 'year') timeText = 'All Time';
          
          document.getElementById('leaderboardOptions').textContent = timeText;
          
          // Update time and reload data
          currentTime = newTime;
          loadLeaderboardData(currentCriteria, currentTime);
          
          // Update heading
          updateLeaderboardHeading(currentCriteria, currentTime);
          
          // NgƒÉn kh√¥ng cho trang cu·ªôn
          return false;
        });
      });
      
      // Function to load leaderboard data
      function loadLeaderboardData(criteria, time) {
        const url = `/getTopPlayersByCriteria?criteria=${criteria}&time=${time}`;
        
        // Show loading state
        showLoadingState();
        
        fetch(url)
          .then(response => {
            if (!response.ok) {
              throw new Error('Network response was not ok');
            }
            return response.json();
          })
          .then(data => {
            // Update UI with new data
            updateLeaderboardUI(data);
          })
          .catch(error => {
            console.error('Error fetching leaderboard data:', error);
            showErrorState();
          });
      }
      
      // Function to show loading state
      function showLoadingState() {
        // Add loading indicators
        document.getElementById('first-place').classList.add('loading');
        document.getElementById('second-place').classList.add('loading');
        document.getElementById('third-place').classList.add('loading');
        document.getElementById('leaderboard-players').innerHTML = '<li class="text-center py-4"><div class="spinner-border text-primary" role="status"><span class="visually-hidden">Loading...</span></div></li>';
      }
      
      // Function to show error state
      function showErrorState() {
        document.getElementById('leaderboard-players').innerHTML = '<li class="text-center py-4 text-danger"><i class="fas fa-exclamation-circle me-2"></i>Failed to load leaderboard data</li>';
      }
      
      // Function to update the UI with new data
      function updateLeaderboardUI(data) {
        const players = data.players;
        
        if (!players || players.length === 0) {
          document.getElementById('leaderboard-players').innerHTML = '<li class="text-center py-4">No players found for this leaderboard</li>';
          return;
        }
        
        // Update top 3 podium
        updatePodium(players);
        
        // Update leaderboard list (players 4-10)
        updateLeaderboardList(players);
        
        // Update prize text based on time period
        updatePrizeText(currentTime);
      }
      
      // Function to update the podium with top 3 players
      function updatePodium(players) {
        // First place
        if (players.length > 0) {
          const first = players[0];
          const firstPlace = document.getElementById('first-place');
          firstPlace.querySelector('img').src = first.avatarUrl || `https://i.pravatar.cc/150?img=${Math.floor(Math.random() * 70)}`;
          firstPlace.querySelector('h5').textContent = first.username || 'Anonymous';
          firstPlace.querySelector('.points span').innerHTML = `<i class="fas fa-bolt"></i> ${formatNumber(first.criteriaValue)}`;
          firstPlace.classList.remove('loading');
        }
        
        // Second place
        if (players.length > 1) {
          const second = players[1];
          const secondPlace = document.getElementById('second-place');
          secondPlace.querySelector('img').src = second.avatarUrl || `https://i.pravatar.cc/150?img=${Math.floor(Math.random() * 70)}`;
          secondPlace.querySelector('h5').textContent = second.username || 'Anonymous';
          secondPlace.querySelector('.points span').innerHTML = `<i class="fas fa-bolt"></i> ${formatNumber(second.criteriaValue)}`;
          secondPlace.classList.remove('loading');
        }
        
        // Third place
        if (players.length > 2) {
          const third = players[2];
          const thirdPlace = document.getElementById('third-place');
          thirdPlace.querySelector('img').src = third.avatarUrl || `https://i.pravatar.cc/150?img=${Math.floor(Math.random() * 70)}`;
          thirdPlace.querySelector('h5').textContent = third.username || 'Anonymous';
          thirdPlace.querySelector('.points span').innerHTML = `<i class="fas fa-bolt"></i> ${formatNumber(third.criteriaValue)}`;
          thirdPlace.classList.remove('loading');
        }
      }
      
      // Function to update the leaderboard list
      function updateLeaderboardList(players) {
        const leaderboardList = document.getElementById('leaderboard-players');
        let html = '';
        
        // Generate list items for players 4 onwards (up to 7)
        const displayCount = Math.min(players.length - 3, 4); // Show at most 4 more players after the top 3
        
        if (displayCount <= 0) {
          html = '<li class="text-center py-3">No additional players to display</li>';
        } else {
          for (let i = 3; i < 3 + displayCount; i++) {
            const player = players[i];
            const trend = Math.random() > 0.5 ? 
              `<div class="leaderboard-trend text-success"><i class="fas fa-caret-up"></i> ${Math.floor(Math.random() * 5) + 1}</div>` : 
              `<div class="leaderboard-trend text-danger"><i class="fas fa-caret-down"></i> ${Math.floor(Math.random() * 5) + 1}</div>`;
              
            html += `
              <li class="leaderboard-item d-flex align-items-center p-3 mb-2 rounded">
                <div class="leaderboard-rank">${i + 1}</div>
                <div class="leaderboard-avatar">
                  <img src="${player.avatarUrl || `https://i.pravatar.cc/150?img=${Math.floor(Math.random() * 70)}`}" alt="${player.username || 'User'}" class="rounded-circle">
                </div>
                <div class="leaderboard-info">
                  <h6 class="mb-0">${player.username || 'Anonymous'}</h6>
                  <small>${Math.floor(Math.random() * 14) + 1} day streak</small>
                </div>
                ${trend}
                <div class="leaderboard-points ms-auto">
                  <span class="badge bg-light text-dark"><i class="fas fa-bolt"></i> ${formatNumber(player.criteriaValue)}</span>
                </div>
              </li>
            `;
          }
          
          // Add current user (placeholder - in a real app you'd check if the current user is in the list)
          html += `
            <li class="leaderboard-item your-rank d-flex align-items-center p-3 rounded">
              <div class="leaderboard-rank">12</div>
              <div class="leaderboard-avatar">
                <img src="https://i.pravatar.cc/150?img=11" alt="Your avatar" class="rounded-circle">
              </div>
              <div class="leaderboard-info">
                <h6 class="mb-0">You</h6>
                <small>2 day streak</small>
              </div>
              <div class="leaderboard-trend text-success"><i class="fas fa-caret-up"></i> 8</div>
              <div class="leaderboard-points ms-auto">
                <span class="badge bg-primary"><i class="fas fa-bolt"></i> ${formatNumber(Math.floor(Math.random() * 3000) + 1000)}</span>
              </div>
            </li>
          `;
        }
        
        leaderboardList.innerHTML = html;
      }
      
      // Function to update the leaderboard heading based on criteria and time
      function updateLeaderboardHeading(criteria, time) {
        const heading = document.querySelector('.leaderboard-section h2');
        let timePeriod = 'This Week\'s';
        
        if (time === 'month') timePeriod = 'This Month\'s';
        else if (time === 'year') timePeriod = 'This Year\'s';
        
        let criteriaType = 'Top Learners';
        if (criteria === 'score') criteriaType = 'Top Scorers';
        else if (criteria === 'attend') criteriaType = 'Most Active Learners';
        else if (criteria === 'mean') criteriaType = 'Highest Accuracy Learners';
        
        heading.textContent = `${timePeriod} ${criteriaType}`;
        
        // Update the badge labels based on criteria
        updateBadgeLabels(criteria);
      }
      
      // Function to update badge labels based on the criteria
      function updateBadgeLabels(criteria) {
        const icon = criteria === 'score' ? 'bolt' : 
                    criteria === 'attend' ? 'check-circle' : 'percentage';
                    
        document.querySelectorAll('.leaderboard-points .badge i').forEach(badge => {
          badge.className = `fas fa-${icon}`;
        });
      }
      
      // Function to update prize text based on time period
      function updatePrizeText(time) {
        const prizeHeader = document.querySelector('.leaderboard-prizes h6');
        if (time === 'week') {
          prizeHeader.innerHTML = '<i class="fas fa-trophy text-warning me-2"></i> Weekly Prizes';
        } else if (time === 'month') {
          prizeHeader.innerHTML = '<i class="fas fa-trophy text-warning me-2"></i> Monthly Prizes';
        } else {
          prizeHeader.innerHTML = '<i class="fas fa-trophy text-warning me-2"></i> Annual Prizes';
        }
      }
      
      // Utility function to format numbers
      function formatNumber(num) {
        if (num >= 1000) {
          return (num / 1000).toFixed(1) + 'k';
        }
        return num;
      }
    });
  </script>